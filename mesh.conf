# Example mesh inventory for wgmesh.sh
# For full mesh connectivity, define every node and set allowed_ips to that
# node's address (and any extra subnets it should advertise).

[mesh]
interface = wg0
port = 51820
dns = 1.1.1.1
mesh_cidr = 10.40.0.0/24  # RFC1918 (or ULA for IPv6)
# topology = fullmesh|star
# hubs = alpha            # Required when topology=star (comma-separated list)
# hub_selection = static|latency
# local_node = alpha  # Optional: default node name for apply on this host.
# exit_nodes = charlie,sierra
# exit_primary = charlie
# exit_policy = latency
# exit_check_interval_seconds = 20
# exit_test_target = 1.1.1.1
# enable_exit_for_nodes = all
# Optional per-node fields:
# forwarding = true|false       # Enable IPv4 forwarding (sysctl) in PostUp.
# nat_iface = eth0              # Add iptables MASQUERADE + forward rules in PostUp.
# post_up = <command>           # Extra PostUp commands (appended after defaults).
# post_down = <command>         # Extra PostDown commands (appended after defaults).

[node "alpha"]
address = 10.40.0.1/32
public_key = <ALPHA_PUBLIC_KEY>
private_key = <ALPHA_PRIVATE_KEY>
private_key_path = /etc/wireguard/alpha.key
ssh_host = alpha
ssh_user = ubuntu
endpoint = alpha.example.com:51820
endpoint_alt = alpha-backup.example.com:51820
allowed_ips = 10.40.0.1/32
persistent_keepalive = 25

[node "bravo"]
address = 10.40.0.2/32
public_key = <BRAVO_PUBLIC_KEY>
private_key = <BRAVO_PRIVATE_KEY>
private_key_path = /etc/wireguard/bravo.key
ssh_host = bravo
ssh_user = ubuntu
endpoint = bravo.example.com:51820
endpoint_alt = bravo-backup.example.com:51820
allowed_ips = 10.40.0.2/32
persistent_keepalive = 25

[node "charlie"]
address = 10.40.0.3/32
public_key = <CHARLIE_PUBLIC_KEY>
private_key = <CHARLIE_PRIVATE_KEY>
private_key_path = /etc/wireguard/charlie.key
ssh_host = charlie
ssh_user = ubuntu
endpoint = charlie.example.com:51820
allowed_ips = 10.40.0.3/32
persistent_keepalive = 25
forwarding = true
nat_iface = eth0
exit_out_iface = eth0
enable_nat = true

[node "tango"]
address = 10.40.0.4/32
public_key = <TANGO_PUBLIC_KEY>
private_key = <TANGO_PRIVATE_KEY>
private_key_path = /etc/wireguard/tango.key
ssh_host = tango
ssh_user = root
ssh_port = 9011
endpoint = tango.example.com:51820
endpoint_alt = tango-backup.example.com:51820
allowed_ips = 10.40.0.4/32
persistent_keepalive = 25
